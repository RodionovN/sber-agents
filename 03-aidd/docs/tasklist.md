# План разработки

## Отчет о прогрессе

| Итерация | Статус       | Описание             | Дата завершения |
| -------- | ------------ | -------------------- | --------------- |
| 1        | ✅ Завершено | Настройка проекта    | 2025-11-29      |
| 2        | ✅ Завершено | Базовый Telegram-бот | 2025-11-29      |
| 3        | ⏸️ Ожидание  | Интеграция с LLM     | -               |
| 4        | ⏸️ Ожидание  | Системный промпт     | -               |
| 5        | ⏸️ Ожидание  | История диалога      | -               |
| 6        | ⏸️ Ожидание  | Обработка ошибок     | -               |

**Легенда:** ✅ Завершено | ⏳ В работе | ⏸️ Ожидание | ❌ Проблема

---

## Итерация 1: Настройка проекта

-   [x] Создать структуру проекта
-   [x] Настроить `uv` для управления зависимостями
-   [x] Добавить базовые зависимости (aiogram, openai, python-dotenv)
-   [x] Создать `.env` файл для конфигурации
-   [x] Настроить `Makefile` с базовыми командами
-   [x] Проверить, что проект запускается

**Результат:** Готовая структура проекта с зависимостями

---

## Итерация 2: Базовый Telegram-бот

-   [x] Создать простой бот с aiogram (polling)
-   [x] Реализовать команду `/start`
-   [x] Реализовать обработку текстовых сообщений (эхо)
-   [x] Добавить базовое логирование
-   [x] Протестировать работу бота в Telegram

**Результат:** Работающий Telegram-бот, отвечающий эхом на сообщения

---

## Итерация 3: Интеграция с LLM

-   [ ] Настроить клиент OpenAI для работы с OpenRouter
-   [ ] Реализовать функцию отправки запроса к LLM
-   [ ] Добавить обработку ответа от LLM
-   [ ] Интегрировать LLM в обработчик сообщений бота
-   [ ] Протестировать получение ответов от LLM

**Результат:** Бот отвечает через LLM вместо эха

---

## Итерация 4: Системный промпт

-   [ ] Добавить системный промпт "Финансовый советник"
-   [ ] Настроить передачу системного промпта в LLM
-   [ ] Протестировать ответы бота в контексте финансового советника

**Результат:** Бот работает в роли финансового советника

---

## Итерация 5: История диалога

-   [ ] Реализовать хранение истории диалога в памяти
-   [ ] Добавить историю в контекст запроса к LLM
-   [ ] Ограничить размер истории (последние N сообщений)
-   [ ] Протестировать диалог с учетом истории

**Результат:** Бот помнит контекст диалога

---

## Итерация 6: Обработка ошибок

-   [ ] Добавить обработку ошибок API (OpenRouter, Telegram)
-   [ ] Реализовать таймауты для запросов к LLM
-   [ ] Добавить информативные сообщения об ошибках пользователю
-   [ ] Улучшить логирование ошибок
-   [ ] Протестировать поведение при ошибках

**Результат:** Стабильный бот с обработкой ошибок
